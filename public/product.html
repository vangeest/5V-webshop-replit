<html>
  </head>
    <!-- add css link-->
  </head>
  <body>
    <nav>
      <ul>
        <li class="active"><a href="index.html">Artikelen</a></li>
        <li><a href="basket.html">Winkelwagen <span class="num_products"></span></a></li>
      </ul>
    </nav>
    <main id="index">
    </main>
    <footer>
      <hr>
      <p>Deze website is gemaakt door <naam leerling> voor het vak informatica op het Emmauscollege Rotterdam. Laatste bijgewerkt 1 oktober 2020.</p>
    </footer>
    <!-- template for product info-->
    <template id="productcard">
      <div class="card">
        <div style="display: flex; justify-content: space-beteen;">
        <h1 syle="display: inline-block"><a href="/index.html">Artikelen</a>&nbsp;&gt;&nbsp;</h1><h1 class="product_title"></h1>
        </div>
        <p class="product_description"></p>
        <img class="product_image">
        <div class="product_price">â‚¬</div>
        <div class="product_code"></div>
        <input class="product_amount" type="number" value="1" min="1">
        <input class="product_id" type="hidden" name="id" data-json="">
        <button onClick="event.stopPropagation();addAmountClosestToBasket(this);">ðŸ›’</button>
      </div>
    </template> 
    <script src="/js/basket.js"></script>
    <script>
      (function() {
        const template = document.querySelector('#productcard');
        const app = document.getElementById('index')
        
        updateBasket()

        const container = document.createElement('div')
        container.setAttribute('class', 'container')

        app.appendChild(container)

        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('productId');

        var request = new XMLHttpRequest()
        request.open('GET', `/api/products/${productId}`, true)
        request.onload = function () {
            var product = JSON.parse(this.response)
            if (request.status >= 200 && request.status < 400) {
                const clone = template.content.cloneNode(true);
                clone.querySelector(".product_title").textContent += product.name
                clone.querySelector(".product_description").textContent =`${product.description}...`
                clone.querySelector(".product_price").textContent += product.price
                clone.querySelector(".product_code").textContent = product.code
                clone.querySelector(".product_id").value = product.id
                clone.querySelector(".product_id").dataset.json = JSON.stringify(product)
                clone.querySelector(".product_image").src =`/images/${product.id}.jpg`

                container.appendChild(clone)
            } else {
              const errorMessage = document.createElement('marquee')
              errorMessage.textContent = `Gah, it's not working!`
              app.appendChild(errorMessage)
            }
          }
        request.send()

      })();
    </script>
  </body>
</html>
